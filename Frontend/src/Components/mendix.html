<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>


<style>
    #mainContainer {
        width: 100%;
        height: 100vh;
        background-color: white;
    }

    #card-container {
        width: 95%;
        margin: 0 auto;
        height: 20vh;
        background-color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: rgb(38, 57, 77) 0px 20px 30px -10px;
    }

    #card {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 30px;
    }

    #list-container {
        width: 95%;
        margin: 36px auto;
        height: 80vh;
        display: flex;
        justify-content: center;
        flex-direction: column;
    }

    li {
        display: flex;
        justify-content: space-around;
        align-items: center;
        box-shadow: rgba(0, 0, 0, 0.16) 0px 3px 6px, rgba(0, 0, 0, 0.23) 0px 3px 6px;
        padding: 10px 20px;
        margin-bottom: 10px;
        border-radius: 10px;
    }
</style>

<body>

    <div id="mainContainer">
        <div class="ip-container">
            <input type="text" name="" id="version" >
            <button id="search">search</button>
        </div>
        <div id="card-container">
            <div id="card">
                <p id="totalBtn">Total : 00</p>
                <h4 id="pendingBtn">Pending : 00</h4>
                <h4 id="approvedBtn">Approved : 00</h4>
                <h4 id="rejectedBtn">Rejected : 00</h4>
            </div>
        </div>
        <div id="list-container">

        </div>
    </div>


    <script>


        const LeaveHistory = [];
        var pending = [];
        var approved = [];
        var rejected = [];
        const totalBtn = document.querySelector('#totalBtn');
        const pendingBtn = document.querySelector('#pendingBtn');
        const rejectedBtn = document.querySelector('#rejectedBtn');
        const approvedBtn = document.querySelector('#approvedBtn');

        const Button = document.querySelector('#search');
        const val = document.querySelector("#version").value;


        function removeElement(ele) {
            const elementToRemove = document.querySelectorAll(`.${ele}`);
            console.log("classToRemove : ", ele);
            console.log("elementToRemove : ", elementToRemove);



            elementToRemove.forEach(box => {
                box.remove();
            })
        }

        function putColor(status) {
            switch (status) {
                case 'pending':
                    return 'orange';
                case 'rejected':
                    return 'red';
                case 'approved':
                    return 'lime';
            }
        }




        function fetchData() {
            fetch(`https://datausa.io/api/data?drilldowns=Nation&measures=Population`)
                .then((res) => res.json())
                .then((resData) => {
                    const response = resData.data;
                    console.log("response.length :: ",response.length)

                    const status = ['pending', 'approved', 'rejected'];
                    response.map((item) => {
                        const st = status[Math.floor(Math.random() * status.length)]
                        LeaveHistory.push({ ...item, status: st });
                    })

                    LeaveHistory.map((item) => {
                        if (item.status == 'pending') {
                            pending.push(item)
                        }
                        else if (item.status == 'rejected') {
                            rejected.push(item)
                        }
                        else if (item.status == 'approved') {
                            approved.push(item);
                        }
                    })
                    console.log("pending : ", pending)

                    document.querySelector('#totalBtn').textContent = `Total : ${LeaveHistory.length}`;
                    document.querySelector('#pendingBtn').textContent = `Pending : ${pending.length}`;
                    document.querySelector('#rejectedBtn').textContent = `Rejected : ${rejected.length}`;
                    document.querySelector('#approvedBtn').textContent = `Approved : ${approved.length}`;

                })
                .catch((err) => console.log(err))

        }


        function showTotal() {
            LeaveHistory.map((item) => {
                console.log("item", item)
                const node = document.createElement("li");
                node.className = "totallist";
                const c1 = document.createElement("div");
                const c2 = document.createElement("div");
                const c3 = document.createElement("div");
                const c4 = document.createElement("div");

                const t1 = document.createTextNode(item?.Nation);
                const t2 = document.createTextNode(item?.Year);
                const t3 = document.createTextNode(item?.Population);
                const t4 = document.createTextNode(item.status);

                c1.appendChild(t1);
                c2.appendChild(t2);
                c3.appendChild(t3);
                c4.appendChild(t4);

                node.appendChild(c1);
                node.appendChild(c2);
                node.appendChild(c3);
                node.appendChild(c4);



                node.style.backgroundColor = putColor(item.status);
                document.getElementById("list-container").appendChild(node);
            })

            setTimeout(() => {
                removeElement('rejectedlist');
                removeElement('pendinglist');
                removeElement('approvedlist');
            }, 0)


        }


        console.log("approved : ", approved)
        console.log("pending : ", pending)
        console.log("rejected : ", rejected)

        function showPending() {
            pending.map((item) => {
                console.log("item", item)
                const node = document.createElement("li");
                node.className = "pendinglist";
                const c1 = document.createElement("div");
                const c2 = document.createElement("div");
                const c3 = document.createElement("div");
                const c4 = document.createElement("div");

                const t1 = document.createTextNode(item?.Nation);
                const t2 = document.createTextNode(item?.Year);
                const t3 = document.createTextNode(item?.Population);
                const t4 = document.createTextNode(item.status);

                c1.appendChild(t1);
                c2.appendChild(t2);
                c3.appendChild(t3);
                c4.appendChild(t4);

                node.appendChild(c1);
                node.appendChild(c2);
                node.appendChild(c3);
                node.appendChild(c4);


                node.style.backgroundColor = putColor(item.status);
                document.getElementById("list-container").appendChild(node);
            })

            setTimeout(() => {
                removeElement('totallist');
                removeElement('rejectedlist');
                removeElement('approvedlist');
            }, 0)

        }
        function showApproved() {
            approved.map((item) => {
                console.log("item", item)
                const node = document.createElement("li");
                node.className = "approvedlist";

                const c1 = document.createElement("div");
                const c2 = document.createElement("div");
                const c3 = document.createElement("div");
                const c4 = document.createElement("div");

                const t1 = document.createTextNode(item?.Nation);
                const t2 = document.createTextNode(item?.Year);
                const t3 = document.createTextNode(item?.Population);
                const t4 = document.createTextNode(item.status);

                c1.appendChild(t1);
                c2.appendChild(t2);
                c3.appendChild(t3);
                c4.appendChild(t4);

                node.appendChild(c1);
                node.appendChild(c2);
                node.appendChild(c3);
                node.appendChild(c4);

                node.style.backgroundColor = putColor(item.status);
                document.getElementById("list-container").appendChild(node);
            })



            setTimeout(() => {
                removeElement('totallist');
                removeElement('rejectedlist');
                removeElement('pendinglist');
            }, 0)

        }
        function showRejected() {
            rejected.map((item) => {
                console.log("item", item)
                const node = document.createElement("li");
                node.className = "rejectedlist";

                const c1 = document.createElement("div");
                const c2 = document.createElement("div");
                const c3 = document.createElement("div");
                const c4 = document.createElement("div");

                const t1 = document.createTextNode(item?.Nation);
                const t2 = document.createTextNode(item?.Year);
                const t3 = document.createTextNode(item?.Population);
                const t4 = document.createTextNode(item.status);

                c1.appendChild(t1);
                c2.appendChild(t2);
                c3.appendChild(t3);
                c4.appendChild(t4);

                node.appendChild(c1);
                node.appendChild(c2);
                node.appendChild(c3);
                node.appendChild(c4);

                node.style.backgroundColor = putColor(item.status);
                document.getElementById("list-container").appendChild(node);
            })

            removeElement('totallist');
            removeElement('pendinglist');
            removeElement('approvedlist');

            setTimeout(() => {
                removeElement('totallist');
                removeElement('pendinglist');
                removeElement('approvedlist');
            }, 0)
        }



        // ---------------------------------------------------------------------calls-------------------------------------------------------------------


        // count.addEventListener('click', showLength);
        window.onload = function () {
            fetchData();
            showTotal();
        };

        totalBtn.addEventListener('click', showTotal);
        pendingBtn.addEventListener('click', showPending);
        rejectedBtn.addEventListener('click', showRejected);
        approvedBtn.addEventListener('click', showApproved);


    </script>
</body>

</html>